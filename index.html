<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROKU - Bar & Restaurant</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #000;
            color: #fff;
            background-image: url('WhatsApp Image 2025-04-12 at 19.55.08_35ed1ea1.jpg');
            background-size: contain; /* Ensures the image is fully visible */
            background-repeat: repeat; /* Tiles the image */
            background-position: center; /* Centers the image */
            min-height: 100vh; /* Ensures the body takes at least the full height of the viewport */
        }
        .overlay {
            background: rgba(0, 0, 0, 0.7);
            min-height: 100vh;
        }
        h1, h2 {
            font-family: 'Playfair Display', serif;
        }
        .menu-item {
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .menu-item img {
            height: 200px;
            object-fit: cover;
        }
        .menu-item .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 1rem;
        }
        .menu-item h4 {
            margin-bottom: 0.5rem;
        }
        .menu-item p {
            flex: 1;
            margin-bottom: 1rem;
        }
        .menu-item .price {
            margin-top: auto;
        }
        .menu-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .glass-effect {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .admin-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            max-height: 50vh;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 50;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        .admin-panel.show {
            transform: translateY(0);
        }
        .admin-panel-content {
            padding-bottom: 0.5rem;
        }
        .admin-panel .p-8 {
            padding: 1rem;
        }
        .admin-panel h2 {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
        }
        .admin-panel h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        .admin-panel .space-y-8 {
            gap: 1rem;
        }
        .admin-panel .space-y-4 {
            gap: 0.5rem;
        }
        .admin-panel input,
        .admin-panel select,
        .admin-panel textarea {
            padding: 0.375rem;
            font-size: 0.875rem;
        }
        .admin-panel button {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
        }
        .admin-panel .grid {
            gap: 0.5rem;
        }
        .admin-panel .flex {
            gap: 0.5rem;
        }
        .admin-panel .mb-6 {
            margin-bottom: 0.75rem;
        }
        .admin-panel .mb-4 {
            margin-bottom: 0.5rem;
        }
        .admin-panel .mt-4 {
            margin-top: 0.5rem;
        }
        .admin-panel .p-4 {
            padding: 0.5rem;
        }
        .admin-panel .rounded-lg {
            border-radius: 0.375rem;
        }
        .admin-panel .rounded-t-lg {
            border-top-left-radius: 0.375rem;
            border-top-right-radius: 0.375rem;
        }
        .save-button {
            position: fixed;
            bottom: 0.75rem;
            right: 0.75rem;
            background: white;
            color: black;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            font-size: 0.875rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            z-index: 51;
        }
        .save-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        .category-nav {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10;
            padding: 1rem 0;
            margin-bottom: 2rem;
            transition: all 0.3s;
        }
        .category-nav.light-mode {
            background: rgba(255, 255, 255, 0.8);
        }
        .category-nav-content {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 0 1rem;
            scrollbar-width: none;
            -ms-overflow-style: none;
            max-width: 100%;
        }
        .category-nav-content::-webkit-scrollbar {
            display: none;
        }
        .category-button {
            white-space: nowrap;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .category-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        .category-button.active {
            background: white;
            color: black;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .light-mode .category-button {
            background: rgba(0, 0, 0, 0.1);
            color: black;
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
        .light-mode .category-button:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        .light-mode .category-button.active {
            background: black;
            color: white;
        }
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 100;
        }
        .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        .light-mode .theme-toggle {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: black;
        }
        .light-mode .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        .light-mode {
            background-color: #fff;
            color: #000;
        }
        .light-mode .overlay {
            background: rgba(255, 255, 255, 0.7);
        }
        .light-mode .glass-effect {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .light-mode .menu-item {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .light-mode .menu-item:hover {
            background: rgba(255, 255, 255, 1);
        }
        .light-mode h1, .light-mode h2, .light-mode h3, .light-mode h4 {
            color: #000;
        }
        .light-mode .text-gray-300 {
            color: #666;
        }
        .light-mode .input-style {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: black;
        }
        .light-mode .input-style:focus {
            background: rgba(0, 0, 0, 0.15);
            border-color: rgba(0, 0, 0, 0.3);
        }
        .light-mode .admin-panel {
            background: rgba(255, 255, 255, 0.95);
        }
        .light-mode .item-detail {
            background: rgba(255, 255, 255, 0.9);
        }
        .input-style {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        .input-style:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }
        .item-detail {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
        }
        .social-links {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        .social-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            padding: 0.5rem;
            border-radius: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
        }
        .social-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        .light-mode .social-link {
            color: black;
            background: rgba(0, 0, 0, 0.1);
        }
        .light-mode .social-link:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        @media (max-width: 640px) {
            .menu-item img {
                height: 150px;
            }
            .menu-item .content {
                padding: 0.75rem;
            }
            .menu-item h4 {
                font-size: 1.1rem;
            }
            .menu-item p {
                font-size: 0.9rem;
            }
            .category-nav-content {
                padding: 0 0.5rem;
            }
            .category-button {
                padding: 0.375rem 0.75rem;
                font-size: 0.875rem;
            }
            .social-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            .social-link {
                font-size: 0.875rem;
                padding: 0.375rem 0.75rem;
            }
        }
        .admin-panel select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.75rem;
            border-radius: 0.375rem;
            width: 100%;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-left: 2.5rem;
            font-size: 1rem;
            transition: all 0.3s;
        }
        .admin-panel select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
        }
        .admin-panel select option {
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.75rem;
        }
        .light-mode .admin-panel select {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: black;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='black'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
        }
        .light-mode .admin-panel select:focus {
            border-color: rgba(0, 0, 0, 0.3);
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        .light-mode .admin-panel select option {
            background: white;
            color: black;
        }
        .blur-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease-in-out;
            z-index: 30;
        }
        .blur-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        #categoriesSidebar {
            box-shadow: -4px 0 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }
        #categoriesSidebar .p-4 {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        #categories {
            overflow-y: auto;
            flex: 1;
            padding-right: 8px;
            margin-right: -8px;
        }
        #categories::-webkit-scrollbar {
            width: 6px;
        }
        #categories::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        #categories::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
        #categories::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }
        .light-mode #categories::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        .light-mode #categories::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.3);
        }
        .light-mode #categories::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.4);
        }
        .menu-toggle {
            position: relative;
            margin-left: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .menu-toggle:hover {
            transform: scale(1.05);
        }
        .light-mode .menu-toggle {
            border: 1px solid rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="blur-overlay" id="blurOverlay" onclick="toggleCategories()"></div>
    <div class="overlay">
        <header class="glass-effect">
            <div class="max-w-6xl mx-auto px-4 py-6">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="flex items-center gap-4">
                        <div class="w-16 h-16 rounded-full overflow-hidden cursor-pointer transition-transform hover:scale-110" onclick="handleLogoClick()">
                            <img src="logo.jpg" 
                                 alt="ROKU Logo" 
                                 class="w-full h-full object-cover">
                        </div>
                        <h1 class="text-4xl font-bold text-white">ROKU</h1>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="social-links">
                            <a href="https://www.instagram.com/roku__restaurant?igsh=MXNoemFjcDdjamx2ZQ==" target="_blank" class="social-link">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.012-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                </svg>
                                Instagram
                            </a>
                            <a href="tel:+989199616772" class="social-link">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                </svg>
                                +98 919 961 6772
                            </a>
                            <a href="https://maps.app.goo.gl/88nYsoEtuPMPohZ78?g_st=aw" target="_blank" class="social-link">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                Location
                            </a>
                        </div>
                        <button onclick="toggleCategories()" class="menu-toggle bg-white/10 hover:bg-white/20 text-white p-2 rounded-lg flex items-center transition-all">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                        <button onclick="toggleTheme()" class="theme-toggle">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-6xl mx-auto px-4 py-12">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold text-white mb-4">Our Menu</h2>
                <p class="text-gray-300 text-lg">Experience the finest dining in town</p>
            </div>

            <!-- Main Content -->
            <main class="container mx-auto px-4 py-8">
                <!-- Categories Sidebar -->
                <div id="categoriesSidebar" class="fixed right-0 top-0 h-full w-64 bg-black/90 transform translate-x-full transition-transform duration-300 ease-in-out z-40">
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-4 sticky top-0 bg-black/90 py-2">
                            <h2 class="text-xl font-bold text-white">Categories</h2>
                            <button onclick="toggleCategories()" class="text-gray-400 hover:text-white">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div id="categories" class="space-y-2">
                            <!-- Categories will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Menu Container -->
                <div id="menuContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
                    <!-- Menu items will be loaded here -->
                </div>
            </main>
        </main>

        <footer class="glass-effect mt-12 py-8">
            <div class="max-w-6xl mx-auto px-4 text-center">
                <div class="text-gray-300 mb-4">
                    <h3 class="text-xl font-semibold text-white mb-2">Working Hours</h3>
                    <p>12:00 - 23:30</p>
                </div>
                <div class="flex justify-center gap-4">
                    <button onclick="showLoginModal()" class="bg-white/10 text-white px-4 py-2 rounded hover:bg-white/20 transition">
                        Admin Panel
                    </button>
                </div>
                <p class="text-gray-300 mt-4">&copy; 2024 ROKU Bar & Restaurant. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <!-- Item Detail Modal -->
    <div id="itemDetailModal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center">
        <div class="item-detail p-8 rounded-lg max-w-4xl w-full mx-4 border border-white/10">
            <div class="flex justify-between items-center mb-6">
                <h2 id="itemDetailTitle" class="text-3xl font-bold text-white"></h2>
                <button onclick="hideItemDetail()" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <img id="itemDetailImage" src="" alt="" class="w-full h-64 object-cover rounded-lg mb-4">
                    <p id="itemDetailDescription" class="text-gray-300 text-lg"></p>
                </div>
                <div>
                    <p id="itemDetailCategory" class="text-xl text-white mb-4"></p>
                    <p id="itemDetailPrice" class="text-2xl font-bold text-white mb-6"></p>
                    <div id="itemDetailIngredients" class="text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center">
        <div class="bg-black p-8 rounded-lg max-w-md w-full mx-4 border border-white/10">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Admin Login</h2>
                <button onclick="hideLoginModal()" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-gray-300 mb-2">Password</label>
                    <input type="password" id="adminPassword" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" required>
                </div>
                <button type="submit" class="w-full bg-white text-black py-2 rounded hover:bg-gray-200 transition">Login</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanel" class="admin-panel">
        <div class="p-8 rounded-t-lg max-w-3xl w-full mx-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-white">Admin Panel</h2>
                <button onclick="hideAdminPanel()" class="text-gray-400 hover:text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="admin-panel-content space-y-6">
                <!-- Category Management -->
                <div>
                    <h3 class="text-lg font-semibold text-white mb-3">Manage Categories</h3>
                    <form id="addCategoryForm" class="space-y-3">
                        <div class="flex gap-3">
                            <div class="flex-1">
                                <input type="text" id="newCategory" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" placeholder="New Category" required>
                            </div>
                            <div class="flex items-end">
                                <button type="submit" class="bg-white text-black py-2 px-4 rounded hover:bg-gray-200 transition">Add</button>
                            </div>
                        </div>
                    </form>
                    <div id="categoriesList" class="mt-3 space-y-2">
                        <!-- Categories will be listed here -->
                    </div>
                </div>

                <!-- Background Image Management -->
                <div>
                    <h3 class="text-lg font-semibold text-white mb-3">Website Background</h3>
                    <div class="space-y-3">
                        <input type="hidden" id="backgroundImageUrl" class="input-style">
                        <div class="relative">
                            <input type="file" id="backgroundImageUpload" accept="image/*" class="hidden" onchange="handleBackgroundImageUpload(event)">
                            <button type="button" onclick="document.getElementById('backgroundImageUpload').click()" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20 text-left flex items-center justify-between">
                                <span id="backgroundImageButtonText">Choose Background Image</span>
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Item Management -->
                <div>
                    <h3 class="text-lg font-semibold text-white mb-3">Add New Item</h3>
                    <form id="addItemForm" class="space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <select id="category" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" required>
                                    <!-- Categories will be populated here -->
                                </select>
                            </div>
                            <div>
                                <input type="text" id="name" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" placeholder="Item Name" required>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <input type="number" id="price" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" placeholder="Price" required>
                            </div>
                            <div>
                                <input type="hidden" id="imageUrl" class="input-style">
                                <div class="relative">
                                    <input type="file" id="imageUpload" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                                    <button type="button" onclick="document.getElementById('imageUpload').click()" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20 text-left flex items-center justify-between">
                                        <span id="imageButtonText">Choose Image</span>
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div>
                            <textarea id="description" class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" placeholder="Description"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-white text-black py-2 rounded hover:bg-gray-200 transition">Add Item</button>
                    </form>
                </div>

                <div>
                    <h3 class="text-lg font-semibold text-white mb-3">Current Menu Items</h3>
                    <div id="adminMenuItems" class="space-y-3">
                        <!-- Admin menu items will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample menu items with more details
        let menuItems = [];
        let currentCategory = 'all';

        // Categories management
        let categories = [];

        // Admin password
        const ADMIN_PASSWORD = 'Roku@2024#Admin$Secure';

        // Theme management
        let isDarkMode = true;

        // Modified loadMenu function
        async function loadMenu() {
            try {
                const response = await fetch('/api/items');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const items = await response.json();
                
                if (!Array.isArray(items)) {
                    throw new Error('Invalid response format from API');
                }

                const itemsByCategory = items.reduce((acc, item) => {
                    if (!acc[item.category_name]) {
                        acc[item.category_name] = [];
                    }
                    acc[item.category_name].push(item);
                    return acc;
                }, {});

                const menuContainer = document.getElementById('menuContainer');
                menuContainer.innerHTML = '';

                if (currentCategory === 'all') {
                    // Show all categories
                    Object.entries(itemsByCategory).forEach(([category, items]) => {
                        const categorySection = document.createElement('div');
                        categorySection.className = 'col-span-full';
                        categorySection.innerHTML = `
                            <h3 class="text-3xl font-bold text-white mb-6 mt-8">${category}</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
                                ${items.map(item => `
                                    <div class="menu-item rounded-lg overflow-hidden" onclick="showItemDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                        <img src="${item.image_url}" alt="${item.name}">
                                        <div class="content">
                                            <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                            <p class="text-gray-300">${item.description.substring(0, 100)}...</p>
                                            <p class="text-lg font-semibold text-white price">${item.price.toLocaleString()} تومان</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        menuContainer.appendChild(categorySection);
                    });
                } else {
                    // Show items for selected category
                    const categoryResponse = await fetch(`/api/categories/${currentCategory}`);
                    if (!categoryResponse.ok) {
                        throw new Error(`Failed to fetch category: ${categoryResponse.status}`);
                    }
                    const category = await categoryResponse.json();
                    
                    const filteredItems = items.filter(item => item.category_id === parseInt(currentCategory));
                    
                    if (filteredItems.length > 0) {
                        menuContainer.innerHTML = `
                            <div class="col-span-full">
                                <h3 class="text-3xl font-bold text-white mb-6">${category.name}</h3>
                                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
                                    ${filteredItems.map(item => `
                                        <div class="menu-item rounded-lg overflow-hidden" onclick="showItemDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                            <img src="${item.image_url}" alt="${item.name}">
                                            <div class="content">
                                                <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                                <p class="text-gray-300">${item.description.substring(0, 100)}...</p>
                                                <p class="text-lg font-semibold text-white price">${item.price.toLocaleString()} تومان</p>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    } else {
                        menuContainer.innerHTML = `
                            <div class="col-span-full text-center py-12">
                                <h3 class="text-3xl font-bold text-white mb-4">${category.name}</h3>
                                <p class="text-gray-300 text-lg">No items found in this category.</p>
                            </div>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error loading menu:', error);
                const menuContainer = document.getElementById('menuContainer');
                menuContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-300 text-lg">Failed to load menu items. Please try again later.</p>
                        <p class="text-gray-400 text-sm mt-2">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Modified showAdminPanel function
        function showAdminPanel() {
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.classList.add('show');
            
            // Load categories and menu items
            loadCategories();
            loadAdminMenuItems();
            
            // Add search input
            const searchInput = document.createElement('div');
            searchInput.className = 'mb-4';
            searchInput.innerHTML = `
                <input type="text" 
                       class="input-style w-full p-2 rounded focus:outline-none focus:ring-2 focus:ring-white/20" 
                       placeholder="Search items..." 
                       oninput="filterAdminItems(this.value)">
            `;
            
            // Insert search input before the menu items list
            const adminMenuItems = document.getElementById('adminMenuItems');
            adminMenuItems.parentNode.insertBefore(searchInput, adminMenuItems);
            
            // Add save button
            const saveButton = document.createElement('button');
            saveButton.className = 'save-button';
            saveButton.textContent = 'Save Changes';
            saveButton.onclick = () => {
                loadMenu();
                loadAdminMenuItems();
                alert('Changes saved successfully!');
            };
            document.body.appendChild(saveButton);
            
            // Add reset database button
            const resetButton = document.createElement('button');
            resetButton.className = 'save-button';
            resetButton.style.right = '150px';
            resetButton.textContent = 'Reset Database';
            resetButton.onclick = resetDatabase;
            document.body.appendChild(resetButton);
        }

        // Modified hideAdminPanel function
        function hideAdminPanel() {
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.classList.remove('show');
            
            // Remove search input
            const searchInput = document.querySelector('.mb-4 input[type="text"]');
            if (searchInput) {
                searchInput.parentNode.remove();
            }
            
            // Remove save button
            const saveButton = document.querySelector('.save-button');
            if (saveButton) {
                saveButton.remove();
            }
            
            // Remove reset button
            const resetButton = document.querySelector('.save-button:nth-child(2)');
            if (resetButton) {
                resetButton.remove();
            }
            
            // Reset form button text
            const submitButton = document.querySelector('#addItemForm button[type="submit"]');
            if (submitButton) {
                submitButton.textContent = 'Add Item';
                delete submitButton.dataset.editId;
            }
            
            // Reset form
            document.getElementById('addItemForm').reset();
            document.getElementById('imageButtonText').textContent = 'Choose Image';
        }

        // Add resetDatabase function
        async function resetDatabase() {
            if (confirm('Are you sure you want to reset the database? This will delete all items and categories. This action cannot be undone.')) {
                try {
                    const response = await fetch('/api/reset', {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        alert('Database reset successfully!');
                        loadCategories();
                        loadMenu();
                        loadAdminMenuItems();
                    } else {
                        alert('Failed to reset database. Please try again.');
                    }
                } catch (error) {
                    console.error('Error resetting database:', error);
                    alert('Failed to reset database. Please try again.');
                }
            }
        }

        // Modified deleteCategory function
        function deleteCategory(category) {
            if (categories.length <= 1) {
                alert('Cannot delete the last category. At least one category must remain.');
                return;
            }
            if (confirm(`Are you sure you want to delete the category "${category}"? This will also delete all items in this category.`)) {
                categories = categories.filter(cat => cat !== category);
                menuItems = menuItems.filter(item => item.category !== category);
                loadCategories();
                loadMenu();
                loadAdminMenuItems();
                saveMenu(); // Save changes immediately
            }
        }

        // Modified loadSavedMenu function
        function loadSavedMenu() {
            const savedMenu = localStorage.getItem('rokuMenu');
            if (savedMenu) {
                try {
                    const menuData = JSON.parse(savedMenu);
                    menuItems = menuData.items || [];
                    categories = menuData.categories || [];
                    
                    // Ensure there's at least one category
                    if (categories.length === 0) {
                        categories = ['Main Menu'];
                        saveMenu();
                    }
                    
                    loadCategories(); // Load categories after loading saved data
                    loadMenu();
                } catch (error) {
                    console.error('Error loading saved menu:', error);
                    // Reset to default if there's an error
                    categories = ['Main Menu'];
                    menuItems = [];
                    saveMenu();
                }
            }
        }

        // Theme management
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-mode');
            document.querySelector('.category-nav').classList.toggle('light-mode');
            const themeIcon = document.querySelector('.theme-toggle svg');
            if (isDarkMode) {
                themeIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>';
            } else {
                themeIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>';
            }
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                isDarkMode = false;
                document.body.classList.add('light-mode');
                document.querySelector('.category-nav').classList.add('light-mode');
                const themeIcon = document.querySelector('.theme-toggle svg');
                themeIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>';
            }
        }

        // Modal functions
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginModal').classList.add('flex');
        }

        function hideLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('loginModal').classList.remove('flex');
        }

        function showItemDetails(item) {
            const detailsContainer = document.getElementById('itemDetails');
            const categoryBar = document.getElementById('categoryBar');
            
            // Hide category bar and menu items
            categoryBar.style.display = 'none';
            document.getElementById('menuItems').style.display = 'none';
            
            detailsContainer.innerHTML = `
                <div class="max-w-4xl mx-auto p-6">
                    <div class="flex justify-between items-start mb-6">
                        <h2 class="text-3xl font-bold text-white">${item.name}</h2>
                        <button onclick="hideItemDetails()" class="text-white hover:text-gray-300">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="relative">
                            <img src="${item.imageUrl}" alt="${item.name}" class="w-full h-96 object-cover rounded-lg shadow-lg">
                        </div>
                        <div class="space-y-4">
                            <p class="text-xl text-white">${item.description}</p>
                            <p class="text-2xl font-bold text-white">${item.price.toLocaleString()} تومان</p>
                            <div class="flex items-center gap-2">
                                <span class="px-3 py-1 bg-white/10 rounded-full text-white">${item.category}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            detailsContainer.style.display = 'block';
            detailsContainer.scrollIntoView({ behavior: 'smooth' });
        }

        function hideItemDetails() {
            const detailsContainer = document.getElementById('itemDetails');
            const categoryBar = document.getElementById('categoryBar');
            const menuItems = document.getElementById('menuItems');
            
            // Show category bar and menu items
            categoryBar.style.display = 'flex';
            menuItems.style.display = 'grid';
            
            detailsContainer.style.display = 'none';
        }

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                hideLoginModal();
                showAdminPanel();
            } else {
                alert('Incorrect password');
            }
        });

        // Category management
        async function loadCategories() {
            try {
                const response = await fetch('/api/categories');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const categories = await response.json();
                
                // Update sidebar categories
                const categoriesContainer = document.getElementById('categories');
                categoriesContainer.innerHTML = `
                    <button onclick="filterByCategory('all')" class="w-full text-left px-4 py-2 rounded-lg text-white hover:bg-white/10 transition-colors">
                        All Items
                    </button>
                    ${categories.map(category => `
                        <button onclick="filterByCategory(${category.id})" class="w-full text-left px-4 py-2 rounded-lg text-white hover:bg-white/10 transition-colors">
                            ${category.name}
                        </button>
                    `).join('')}
                `;

                // Update admin panel category select
                const categorySelect = document.getElementById('category');
                categorySelect.innerHTML = `
                    <option value="">Select a category</option>
                    ${categories.map(category => `
                        <option value="${category.id}">${category.name}</option>
                    `).join('')}
                `;

                // Update admin panel categories list
                const categoriesList = document.getElementById('categoriesList');
                categoriesList.innerHTML = categories.map(category => `
                    <div class="flex justify-between items-center p-2 bg-white/5 rounded">
                        <span class="text-white">${category.name}</span>
                        <div class="flex gap-2">
                            <button onclick="editCategory(${category.id}, '${category.name}')" class="text-blue-400 hover:text-blue-300">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button onclick="deleteCategory(${category.id})" class="text-red-400 hover:text-red-300">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading categories:', error);
                const categoriesContainer = document.getElementById('categories');
                categoriesContainer.innerHTML = `
                    <div class="text-red-400 text-center py-4">
                        Failed to load categories. Please try again later.
                    </div>
                `;
            }
        }

        // Add edit category functionality
        async function editCategory(categoryId, currentName) {
            const newName = prompt('Enter new category name:', currentName);
            if (newName && newName !== currentName) {
                try {
                    const response = await fetch(`/api/categories/${categoryId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ name: newName })
                    });
                    
                    if (response.ok) {
                        loadCategories();
                    } else {
                        alert('Failed to update category. Please try again.');
                    }
                } catch (error) {
                    console.error('Error updating category:', error);
                    alert('Failed to update category. Please try again.');
                }
            }
        }

        // Add delete category functionality
        async function deleteCategory(categoryId) {
            if (confirm('Are you sure you want to delete this category? This will also delete all items in this category.')) {
                try {
                    const response = await fetch(`/api/categories/${categoryId}`, {
                        method: 'DELETE'
                    });
                    
                    if (response.ok) {
                        loadCategories();
                        loadMenu();
                    } else {
                        alert('Failed to delete category. Please try again.');
                    }
                } catch (error) {
                    console.error('Error deleting category:', error);
                    alert('Failed to delete category. Please try again.');
                }
            }
        }

        // Add category form handler
        document.getElementById('addCategoryForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const newCategory = document.getElementById('newCategory').value.trim();
            
            if (newCategory) {
                try {
                    const response = await fetch('/api/categories', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ name: newCategory })
                    });
                    
                    if (response.ok) {
                        document.getElementById('newCategory').value = '';
                        loadCategories();
                    } else {
                        alert('Failed to add category. Please try again.');
                    }
                } catch (error) {
                    console.error('Error adding category:', error);
                    alert('Failed to add category. Please try again.');
                }
            }
        });

        // Update the filterByCategory function to work with sidebar
        async function filterByCategory(categoryId) {
            try {
                currentCategory = categoryId;
                const response = await fetch('/api/items');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const items = await response.json();
                
                if (!Array.isArray(items)) {
                    throw new Error('Invalid response format from API');
                }

                const menuContainer = document.getElementById('menuContainer');
                menuContainer.innerHTML = '';
                
                if (categoryId === 'all') {
                    // Group items by category
                    const itemsByCategory = items.reduce((acc, item) => {
                        if (!acc[item.category_name]) {
                            acc[item.category_name] = [];
                        }
                        acc[item.category_name].push(item);
                        return acc;
                    }, {});
                    
                    // Show all categories
                    Object.entries(itemsByCategory).forEach(([category, items]) => {
                        const categorySection = document.createElement('div');
                        categorySection.className = 'col-span-full';
                        categorySection.innerHTML = `
                            <h3 class="text-3xl font-bold text-white mb-6 mt-8">${category}</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
                                ${items.map(item => `
                                    <div class="menu-item rounded-lg overflow-hidden" onclick="showItemDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                        <img src="${item.image_url}" alt="${item.name}">
                                        <div class="content">
                                            <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                            <p class="text-gray-300">${item.description.substring(0, 100)}...</p>
                                            <p class="text-lg font-semibold text-white price">${item.price.toLocaleString()} تومان</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        menuContainer.appendChild(categorySection);
                    });
                } else {
                    // Show items for selected category
                    try {
                        const categoryResponse = await fetch(`/api/categories/${categoryId}`);
                        if (!categoryResponse.ok) {
                            if (categoryResponse.status === 404) {
                                menuContainer.innerHTML = `
                                    <div class="col-span-full text-center py-12">
                                        <p class="text-gray-300 text-lg">Category not found. Please try again.</p>
                                    </div>
                                `;
                                return;
                            }
                            throw new Error(`Failed to fetch category: ${categoryResponse.status}`);
                        }
                        const category = await categoryResponse.json();
                        
                        const filteredItems = items.filter(item => item.category_id === parseInt(categoryId));
                        
                        if (filteredItems.length > 0) {
                            menuContainer.innerHTML = `
                                <div class="col-span-full">
                                    <h3 class="text-3xl font-bold text-white mb-6">${category.name}</h3>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
                                        ${filteredItems.map(item => `
                                            <div class="menu-item rounded-lg overflow-hidden" onclick="showItemDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                                <img src="${item.image_url}" alt="${item.name}">
                                                <div class="content">
                                                    <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                                    <p class="text-gray-300">${item.description.substring(0, 100)}...</p>
                                                    <p class="text-lg font-semibold text-white price">${item.price.toLocaleString()} تومان</p>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        } else {
                            menuContainer.innerHTML = `
                                <div class="col-span-full text-center py-12">
                                    <h3 class="text-3xl font-bold text-white mb-4">${category.name}</h3>
                                    <p class="text-gray-300 text-lg">No items found in this category.</p>
                                </div>
                            `;
                        }
                    } catch (error) {
                        console.error('Error fetching category:', error);
                        menuContainer.innerHTML = `
                            <div class="col-span-full text-center py-12">
                                <p class="text-gray-300 text-lg">Failed to load category. Please try again later.</p>
                                <p class="text-gray-400 text-sm mt-2">Error: ${error.message}</p>
                            </div>
                        `;
                    }
                }
                
                // Close the sidebar after selecting a category
                toggleCategories();
            } catch (error) {
                console.error('Error filtering items:', error);
                const menuContainer = document.getElementById('menuContainer');
                menuContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-300 text-lg">Failed to load menu items. Please try again later.</p>
                        <p class="text-gray-400 text-sm mt-2">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Modified loadAdminMenuItems function
        async function loadAdminMenuItems() {
            try {
                const response = await fetch('/api/items');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const items = await response.json();
                
                if (!Array.isArray(items)) {
                    throw new Error('Invalid response format from API');
                }

                const adminMenuItems = document.getElementById('adminMenuItems');
                adminMenuItems.innerHTML = items.map(item => `
                    <div class="border border-white/10 p-4 rounded flex justify-between items-center">
                        <div class="flex-1">
                            <h3 class="font-semibold text-white">${item.name}</h3>
                            <p class="text-gray-300">${item.category_name}</p>
                            <p class="text-gray-300">${item.price.toLocaleString()} تومان</p>
                            ${item.description ? `<p class="text-gray-400 text-sm mt-1">${item.description}</p>` : ''}
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editItem(${item.id})" class="text-blue-400 hover:text-blue-300" title="Edit">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button onclick="deleteItem(${item.id})" class="text-red-400 hover:text-red-300" title="Delete">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading admin menu items:', error);
                const adminMenuItems = document.getElementById('adminMenuItems');
                adminMenuItems.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-300 text-lg">Failed to load menu items. Please try again later.</p>
                        <p class="text-gray-400 text-sm mt-2">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Modified editItem function
        async function editItem(itemId) {
            try {
                // First, fetch the item details
                const response = await fetch(`/api/items/${itemId}`);
                if (!response.ok) {
                    throw new Error(`Failed to fetch item: ${response.status}`);
                }
                const item = await response.json();

                // Get form elements
                const form = document.getElementById('addItemForm');
                const categorySelect = document.getElementById('category');
                const nameInput = document.getElementById('name');
                const priceInput = document.getElementById('price');
                const descriptionInput = document.getElementById('description');
                const imageUrlInput = document.getElementById('imageUrl');
                const imageButtonText = document.getElementById('imageButtonText');
                const submitButton = form.querySelector('button[type="submit"]');

                // Set form values with the item's details
                categorySelect.value = item.category_id;
                nameInput.value = item.name;
                priceInput.value = item.price;
                descriptionInput.value = item.description || '';
                imageUrlInput.value = item.image_url || '';
                imageButtonText.textContent = item.image_url ? 'Current Image' : 'Choose Image (Optional)';

                // Update submit button text and add data attribute
                submitButton.textContent = 'Update Item';
                submitButton.dataset.editId = itemId;

                // Scroll to form
                form.scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Error in editItem:', error);
                alert('Failed to load item details. Please try again.');
            }
        }

        // Modified deleteItem function
        async function deleteItem(id) {
            if (confirm('Are you sure you want to delete this item?')) {
                try {
                    const response = await fetch(`/api/items/${id}`, {
                        method: 'DELETE'
                    });
                    
                    if (response.ok) {
                        loadMenu();
                        loadAdminMenuItems();
                        alert('Item deleted successfully!');
                    } else {
                        alert('Failed to delete item. Please try again.');
                    }
                } catch (error) {
                    console.error('Error deleting item:', error);
                    alert('Failed to delete item. Please try again.');
                }
            }
        }

        // Modified filterAdminItems function
        async function filterAdminItems(searchTerm) {
            try {
                const response = await fetch('/api/items');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const items = await response.json();
                
                if (!Array.isArray(items)) {
                    throw new Error('Invalid response format from API');
                }

                const filteredItems = items.filter(item => 
                    item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.category_name.toLowerCase().includes(searchTerm.toLowerCase())
                );
                
                const adminMenuItems = document.getElementById('adminMenuItems');
                adminMenuItems.innerHTML = filteredItems.map(item => `
                    <div class="border border-white/10 p-4 rounded flex justify-between items-center">
                        <div class="flex-1">
                            <h3 class="font-semibold text-white">${item.name}</h3>
                            <p class="text-gray-300">${item.category_name}</p>
                            <p class="text-gray-300">${item.price.toLocaleString()} تومان</p>
                            ${item.description ? `<p class="text-gray-400 text-sm mt-1">${item.description}</p>` : ''}
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editItem(${item.id})" class="text-blue-400 hover:text-blue-300" title="Edit">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button onclick="deleteItem(${item.id})" class="text-red-400 hover:text-red-300" title="Delete">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error filtering items:', error);
                const adminMenuItems = document.getElementById('adminMenuItems');
                adminMenuItems.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <p class="text-gray-300 text-lg">Failed to filter items. Please try again later.</p>
                        <p class="text-gray-400 text-sm mt-2">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Save functionality
        function saveMenu() {
            const menuData = {
                items: menuItems,
                categories: categories
            };
            localStorage.setItem('rokuMenu', JSON.stringify(menuData));
            alert('Menu saved successfully!');
            loadCategories(); // Reload categories after saving
            loadMenu(); // Reload menu after saving
        }

        // Background image upload handler
        async function handleBackgroundImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    const imageData = e.target.result;
                    document.getElementById('backgroundImageUrl').value = imageData;
                    document.getElementById('backgroundImageButtonText').textContent = file.name;
                    
                    try {
                        const response = await fetch('/api/wallpaper', {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ background_image: imageData })
                        });
                        
                        if (response.ok) {
                            document.body.style.backgroundImage = `url('${imageData}')`;
                            alert('Background image updated successfully!');
                        } else {
                            alert('Failed to update background image. Please try again.');
                        }
                    } catch (error) {
                        console.error('Error updating background image:', error);
                        alert('Failed to update background image. Please try again.');
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        // Load saved background image on startup
        async function loadBackgroundImage() {
            try {
                const response = await fetch('/api/wallpaper');
                const data = await response.json();
                
                if (data.background_image) {
                    document.body.style.backgroundImage = `url('${data.background_image}')`;
                    document.getElementById('backgroundImageUrl').value = data.background_image;
                    document.getElementById('backgroundImageButtonText').textContent = 'Current Background';
                }
            } catch (error) {
                console.error('Error loading background image:', error);
            }
        }

        // Image upload handler
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imageUrl').value = e.target.result;
                    document.getElementById('imageButtonText').textContent = file.name;
                };
                reader.readAsDataURL(file);
            }
        }

        // Add this new function for toggling categories
        function toggleCategories() {
            const sidebar = document.getElementById('categoriesSidebar');
            const overlay = document.getElementById('blurOverlay');
            sidebar.classList.toggle('translate-x-full');
            overlay.classList.toggle('active');
            
            // Prevent body scrolling when sidebar is open
            document.body.style.overflow = sidebar.classList.contains('translate-x-full') ? '' : 'hidden';
        }

        // Add the handleLogoClick function
        function handleLogoClick() {
            currentCategory = 'all';
            loadMenu();
        }

        // Initial load
        loadTheme();
        loadCategories();
        loadMenu();
        loadBackgroundImage();

        // Add item form handler
        document.getElementById('addItemForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const categoryId = document.getElementById('category').value;
            const name = document.getElementById('name').value;
            const price = document.getElementById('price').value;
            const description = document.getElementById('description').value;
            const imageUrl = document.getElementById('imageUrl').value;
            
            if (!categoryId || !name || !price) {
                alert('Please fill in all required fields (Category, Name, and Price)');
                return;
            }
            
            const submitButton = e.target.querySelector('button[type="submit"]');
            const isEdit = submitButton.dataset.editId;
            
            try {
                const itemData = {
                    category_id: parseInt(categoryId),
                    name: name,
                    price: parseFloat(price),
                    description: description,
                    image_url: imageUrl || 'logo.jpg' // Use logo.jpg as default image
                };
                
                console.log('Sending item data:', itemData);
                
                const response = await fetch('/api/items' + (isEdit ? `/${isEdit}` : ''), {
                    method: isEdit ? 'PUT' : 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(itemData)
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                }
                
                // Reset form
                e.target.reset();
                document.getElementById('imageButtonText').textContent = 'Choose Image (Optional)';
                
                // Reset submit button
                submitButton.textContent = 'Add Item';
                delete submitButton.dataset.editId;
                
                // Reload menu and admin items
                await loadMenu();
                await loadAdminMenuItems();
                
                alert(isEdit ? 'Item updated successfully!' : 'Item added successfully!');
            } catch (error) {
                console.error('Error saving item:', error);
                alert('Failed to save item: ' + error.message);
            }
        });
    </script>
</body>
</html> 